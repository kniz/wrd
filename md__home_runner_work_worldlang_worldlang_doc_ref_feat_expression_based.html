<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>world-doc: Expression based</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">world-doc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Expression based </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>대부분의 keyword는 expression으로 평가된다.</h1>
<h1>ret 는 expression의 값을 도중에 반환한다.</h1>
<h1>if 도 expression으로 취급한다.</h1>
<div class="fragment"><div class="line">flag := true</div>
<div class="line">val := if flag</div>
<div class="line">    ret 3</div>
<div class="line">else</div>
<div class="line">    ret 5</div>
</div><!-- fragment --><ul>
<li>else를 명시하지 않은 경우 해당 타입의 기본값이 할당된다.<ul>
<li>primitive 라면 0 혹은 ""이 할당되며, 커스텀 타입이라면 null이 들어간다.</li>
</ul>
</li>
</ul>
<h1>for 도 expression으로 평가된다.</h1>
<div class="fragment"><div class="line">arr := [1, 2, 3, 4]</div>
<div class="line">lastElem := for e in arr</div>
<div class="line">    if e == 4: ret e * 5</div>
<div class="line">    print(e)</div>
<div class="line">lastElem == 20</div>
</div><!-- fragment --><h1>def 도 expression으로 평가된다.</h1>
<div class="fragment"><div class="line">def myObj</div>
<div class="line">    say() void = null</div>
<div class="line"> </div>
<div class="line">foo(object myObj) void</div>
<div class="line">    object.say()    </div>
<div class="line"> </div>
<div class="line">foo(def helloObj() myObj</div>
<div class="line">    say() void</div>
<div class="line">        print(&quot;hello world&quot;))</div>
<div class="line"> </div>
<div class="line">/*</div>
<div class="line">foo(def helloObj myObj // 이 경우 origin 객체이므로 호출이 불가능하다.</div>
<div class="line">    say() void</div>
<div class="line">        print(&quot;hello world&quot;)</div>
<div class="line">)</div>
<div class="line">*/</div>
</div><!-- fragment --><h1>expression으로 판정시 반환형은 ret 키워드로 판단한다.</h1>
<div class="fragment"><div class="line">arr := [1, 2, 33, 44]</div>
<div class="line">a := for e : arr</div>
<div class="line">    if e &gt; 22: ret e</div>
<div class="line">    if e == 44: ret e as str</div>
</div><!-- fragment --><ul>
<li>ret e 는 int 이며 ret e as str 는 str 로 반환한다.</li>
<li>int와 str의 공통 타입은 obj 가 된다.</li>
<li>a 는 obj 타입이다.</li>
</ul>
<h1>ret 가 없는 블록문은 void로 판단되며 다른 ret 타입을 우선한다.</h1>
<div class="fragment"><div class="line">a := if e &lt; 2</div>
<div class="line">    ret e * 2 // int로 유도된다.</div>
<div class="line">else</div>
<div class="line">    print(&quot;else&quot;) // void로 유도된다.</div>
</div><!-- fragment --><ul>
<li>a는 void + int 최종적으로 int 타입이며 e &gt;= 2일때는 a에 int의 기본값이 할당된다.</li>
</ul>
<h2>note: 왜 ret를 꼭 사용해야 하는가?</h2>
<ul>
<li>위의 예제에서 마지막 줄에 print("else") 에서 사용자는 아무런 값도 반환하고자 하지 않았다.</li>
<li>하지만 만약 print의 시그내처가 print(msg str) str[] 이었다면, a는 최종적으로 str[] + int =&gt; obj 로 유도되고 만다.</li>
<li>문제는 사용자가 정의한 a 변수에는 타입이 명시되지 않기 때문에 사용자는 int라고 생각할 가능성이 높다는 데 있다.</li>
<li>또한 print가 외부 라이브러리였으며 version 업데이트로 print의 반환형이 바뀌었을때, 위와 같은 많은 예제들에서 에러가 발생할 것이다.</li>
</ul>
<h1>ret가 없는 경우 expression으로 받으면 에러가 된다.</h1>
<div class="fragment"><div class="line">a := if flag // err: a에 할당될 블록문에 어떤 라인에서도 ret를 찾지 못했다.</div>
<div class="line">    22</div>
<div class="line">else</div>
<div class="line">    if doSomething()</div>
<div class="line">        30</div>
<div class="line">    else</div>
<div class="line">        44</div>
<div class="line"> </div>
<div class="line">a := if flag // ok:</div>
<div class="line">    22</div>
<div class="line">else</div>
<div class="line">    if doSomething()</div>
<div class="line">        ret 30</div>
<div class="line">    else</div>
<div class="line">        44</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
